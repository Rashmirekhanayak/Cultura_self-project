<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Cultura</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      background: url('{{ url_for('static', filename='images/chat_pic.jpg') }}') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Roboto', sans-serif;
    }

    header {
      background: rgba(44, 62, 80, 0.6);
      backdrop-filter: blur(10px);
      padding: 15px;
      color: white;
      text-align: center;
      font-size: 30px;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .navbar {
        background: rgba(44, 62, 80, 0.8);
        backdrop-filter: blur(10px);
        padding: 15px 30px;
        display: flex;
        height: 60px;
        justify-content: space-between;
        align-items: center;
      }
      .navbar .logo {
        font-weight: bold;
        font-size: 40px;
        color: white;
      }
      .navbar nav a {
        color: white;
        text-decoration: none;
        margin-left: 20px;
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 30px;
        transition: background 0.3s ease;
      }
      .navbar nav a:hover, .navbar nav a.active {
        background: rgba(255,255,255,0.2);
      }


    .chat-container {
      background: rgba(255, 255, 255, 0.3);
      backdrop-filter: blur(15px);
      padding: 20px;
      border-radius: 20px;
      width: 800px;
      max-width: 90%;
      height: 600px;
      margin: 30px auto;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    }

    h2 {
      text-align: center;
      color: rgba(17, 18, 19, 0.81);
      font-size: 40px;
    }

    #chat-box {
      background: rgba(255, 255, 255, 0.29);
      border-radius: 10px;
      padding: 15px;
      height: 300px;
      overflow-y: auto;
      margin-bottom: 15px;
    }

    #chat-form {
      display: flex;
      gap: 10px;
    }

    #user-input {
      flex-grow: 1;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      font-size: 25px;

    }

    button[type="submit"] {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      font-size: 20px;
      background-color: #2c3e50;
      color: white;
      cursor: pointer;
    }

    .preview {
      background: rgba(255, 255, 255, 0.35);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 20px;
      width: 800px;
      margin: 30px auto 0;
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
      text-align: center;
    }

    .preview h2 {
      font-size: 30px;
      color: rgba(8, 8, 8, 0.97);
    }

    .preview p {
      font-size: 30px;
    }

    .preview button {
      margin-top: 20px;
      padding: 10px 30px;
      background-color: #2ecc71;
      color: white;
      border: none;
      border-radius: 20px;
      font-size: 25px;
      cursor: pointer;
    }
    
  </style>
</head>
<body>

    <header class="navbar">
        <div class="logo">üåè Cultura</div>
        <nav>
          <a href="{{ url_for('home') }}" class="{% if active_page == 'home' %}active{% endif %}">Home</a>
          <a href="{{ url_for('dashboard') }}" class="{% if active_page == 'dashboard' %}active{% endif %}">Ask AI</a>
          <a href="{{ url_for('submissions') }}" class="{% if active_page == 'submissions' %}active{% endif %}">Submissions</a>
          <a href="{{ url_for('favorites') }}" class="{% if active_page == 'favorites' %}active{% endif %}">Favorites</a>
          <a href="{{ url_for('feedback') }}" class="{% if active_page == 'feedback' %}active{% endif %}">Feedback</a>
          <a href="{{ url_for('wisdom_feed') }}" class="{% if active_page == 'wisdom_feed' %}active{% endif %}">Wisdom Feed</a>
        </nav>
      </header>
      

  <div class="preview" id="preview-container">
    <h2>üåø Welcome to Cultura AI</h2>
    <p>This is your cultural guide for wisdom, habits, and life advice across the world.</p>
    <p><strong>Example:</strong> "I feel lost in my career"</p>
    <button onclick="startChat()">Start Chat</button>
  </div>

  <div id="chat-section" style="display: none;">
    <div class="chat-container">
      <h2>üåø Cultura Wisdom Chat</h2>

      <div id="chat-box">
        <div id="chat-messages"></div>
      </div>

      <form id="chat-form">
        <input type="text" id="user-input" placeholder="Share your thoughts...">
        <button type="submit">Send</button>
      </form>
    </div>
  </div>

  <script>
    function startChat() {
      document.getElementById('preview-container').style.display = 'none';
      document.getElementById('chat-section').style.display = 'block';
    }

    const form = document.getElementById('chat-form');
    const userInput = document.getElementById('user-input');
    const chatMessages = document.getElementById('chat-messages');
    const chatBox = document.getElementById('chat-box');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const text = userInput.value.trim();
      if (!text) return;

      const userMsg = document.createElement('div');
      userMsg.className = 'chat-entry user';
      userMsg.innerHTML = `<b>You:</b> ${text}`;
      chatMessages.appendChild(userMsg);

      userInput.value = '';

      const botThinking = document.createElement('div');
      botThinking.className = 'chat-entry bot';
      botThinking.id = 'thinking';
      botThinking.innerHTML = `<i>Cultura AI is thinking...</i>`;
      chatMessages.appendChild(botThinking);

      chatBox.scrollTop = chatBox.scrollHeight;

      try {
        const res = await fetch('/chat', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: text })
        });

        const data = await res.json();
        document.getElementById('thinking').remove();

        const botMsg = document.createElement('div');
        botMsg.className = 'chat-entry bot';
        botMsg.innerHTML = `<b>Cultura AI:</b><br>` + data.reply.replace(/\n/g, "<br>");
        chatMessages.appendChild(botMsg);

        chatBox.scrollTop = chatBox.scrollHeight;
      } catch (err) {
        document.getElementById('thinking').remove();
        const errorMsg = document.createElement('div');
        errorMsg.className = 'chat-entry bot';
        errorMsg.innerHTML = "‚ùó Error talking to AI. Please try again later.";
        chatMessages.appendChild(errorMsg);
        chatBox.scrollTop = chatBox.scrollHeight;
      }
    });
  </script>

</body>
</html>
